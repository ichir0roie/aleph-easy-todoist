(()=>{var x=Object.defineProperty,K=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var w=(r,e,t)=>e in r?x(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,_=(r,e)=>{for(var t in e||(e={}))Q.call(e,t)&&w(r,t,e[t]);if(W)for(var t of W(e))ee.call(e,t)&&w(r,t,e[t]);return r},M=(r,e)=>K(r,X(e)),te=r=>x(r,"__esModule",{value:!0});var re=(r,e)=>{te(r);for(var t in e)x(r,t,{get:e[t],enumerable:!0})};var z=(r,e,t)=>(w(r,typeof e!="symbol"?e+"":e,t),t),O=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var C=(r,e,t)=>(O(r,e,"read from private field"),t?t.call(r):e.get(r)),q=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},I=(r,e,t,a)=>(O(r,e,"write to private field"),a?a.call(r,t):e.set(r,t),t);var D={};re(D,{default:()=>G});var{useContext:ae,useMemo:me}=__ALEPH__.pack["https://esm.sh/react@17.0.2"],{default:fe}=__ALEPH__.pack["https://deno.land/x/aleph@v0.3.0-beta.19/shared/util.ts"],{default:he}=__ALEPH__.pack["https://deno.land/x/aleph@v0.3.0-beta.19/framework/core/events.ts"],{RouterContext:oe,SSRContext:pe}=__ALEPH__.pack["https://deno.land/x/aleph@v0.3.0-beta.19/framework/react/context.ts"],{inDeno:be}=__ALEPH__.pack["https://deno.land/x/aleph@v0.3.0-beta.19/framework/react/helper.ts"];function g(){return ae(oe)}var{createElement:ke,ComponentType:ye,ComponentPropsWithRef:ge,FC:Ee,ReactElement:Te,useContext:xe,useEffect:we,useState:_e}=__ALEPH__.pack["https://esm.sh/react@17.0.2"],{FallbackContext:Me}=__ALEPH__.pack["https://deno.land/x/aleph@v0.3.0-beta.19/framework/react/context.ts"],{isLikelyReactComponent:Ce}=__ALEPH__.pack["https://deno.land/x/aleph@v0.3.0-beta.19/framework/react/helper.ts"];var{createElement:Ue,PropsWithChildren:Pe,ReactNode:De}=__ALEPH__.pack["https://esm.sh/react@17.0.2"],{FallbackContext:Fe}=__ALEPH__.pack["https://deno.land/x/aleph@v0.3.0-beta.19/framework/react/context.ts"];var S=class{constructor(e=[]){z(this,"rules");this.rules=e}addRule(e,t){return this.rules.push({test:e,fn:t}),this}tokenize(e,t=a=>a){function*a(n){let s=0;for(let m of n){let f=m.test(e);if(f){let{value:p,length:v}=f;s+=v,e=e.slice(v);let y=M(_({},m.fn(p)),{index:s});yield t(y),yield*a(n)}}}let c=a(this.rules),o=[];for(let n of c)o.push(n);if(e.length)throw new Error(`parser error: string not fully parsed! ${e.slice(0,25)}`);return o}};function h(r,e=2){return String(r).padStart(e,"0")}function d(r){return e=>e.startsWith(r)?{value:r,length:r.length}:void 0}function Z(r){return e=>{let t=r.exec(e);if(t)return{value:t,length:t[0].length}}}var ne=[{test:d("yyyy"),fn:()=>({type:"year",value:"numeric"})},{test:d("yy"),fn:()=>({type:"year",value:"2-digit"})},{test:d("MM"),fn:()=>({type:"month",value:"2-digit"})},{test:d("M"),fn:()=>({type:"month",value:"numeric"})},{test:d("dd"),fn:()=>({type:"day",value:"2-digit"})},{test:d("d"),fn:()=>({type:"day",value:"numeric"})},{test:d("HH"),fn:()=>({type:"hour",value:"2-digit"})},{test:d("H"),fn:()=>({type:"hour",value:"numeric"})},{test:d("hh"),fn:()=>({type:"hour",value:"2-digit",hour12:!0})},{test:d("h"),fn:()=>({type:"hour",value:"numeric",hour12:!0})},{test:d("mm"),fn:()=>({type:"minute",value:"2-digit"})},{test:d("m"),fn:()=>({type:"minute",value:"numeric"})},{test:d("ss"),fn:()=>({type:"second",value:"2-digit"})},{test:d("s"),fn:()=>({type:"second",value:"numeric"})},{test:d("SSS"),fn:()=>({type:"fractionalSecond",value:3})},{test:d("SS"),fn:()=>({type:"fractionalSecond",value:2})},{test:d("S"),fn:()=>({type:"fractionalSecond",value:1})},{test:d("a"),fn:r=>({type:"dayPeriod",value:r})},{test:Z(/^(')(?<value>\\.|[^\']*)\1/),fn:r=>({type:"literal",value:r.groups.value})},{test:Z(/^.+?\s*/),fn:r=>({type:"literal",value:r[0]})}],b,E=class{constructor(e,t=ne){q(this,b,void 0);let a=new S(t);I(this,b,a.tokenize(e,({type:c,value:o,hour12:n})=>{let s={type:c,value:o};return n&&(s.hour12=n),s}))}format(e,t={}){let a="",c=t.timeZone==="UTC";for(let o of C(this,b))switch(o.type){case"year":{let s=c?e.getUTCFullYear():e.getFullYear();switch(o.value){case"numeric":{a+=s;break}case"2-digit":{a+=h(s,2).slice(-2);break}default:throw Error(`FormatterError: value "${o.value}" is not supported`)}break}case"month":{let s=(c?e.getUTCMonth():e.getMonth())+1;switch(o.value){case"numeric":{a+=s;break}case"2-digit":{a+=h(s,2);break}default:throw Error(`FormatterError: value "${o.value}" is not supported`)}break}case"day":{let s=c?e.getUTCDate():e.getDate();switch(o.value){case"numeric":{a+=s;break}case"2-digit":{a+=h(s,2);break}default:throw Error(`FormatterError: value "${o.value}" is not supported`)}break}case"hour":{let s=c?e.getUTCHours():e.getHours();switch(s-=o.hour12&&e.getHours()>12?12:0,o.value){case"numeric":{a+=s;break}case"2-digit":{a+=h(s,2);break}default:throw Error(`FormatterError: value "${o.value}" is not supported`)}break}case"minute":{let s=c?e.getUTCMinutes():e.getMinutes();switch(o.value){case"numeric":{a+=s;break}case"2-digit":{a+=h(s,2);break}default:throw Error(`FormatterError: value "${o.value}" is not supported`)}break}case"second":{let s=c?e.getUTCSeconds():e.getSeconds();switch(o.value){case"numeric":{a+=s;break}case"2-digit":{a+=h(s,2);break}default:throw Error(`FormatterError: value "${o.value}" is not supported`)}break}case"fractionalSecond":{let s=c?e.getUTCMilliseconds():e.getMilliseconds();a+=h(s,Number(o.value));break}case"timeZoneName":break;case"dayPeriod":{a+=o.value?e.getHours()>=12?"PM":"AM":"";break}case"literal":{a+=o.value;break}default:throw Error(`FormatterError: { ${o.type} ${o.value} }`)}return a}parseToParts(e){var a,c,o,n,s,m,f,p,v,y,F,H,$,A,R,L,j;let t=[];for(let i of C(this,b)){let Y=i.type,l="";switch(i.type){case"year":{switch(i.value){case"numeric":{l=(a=/^\d{1,4}/.exec(e))==null?void 0:a[0];break}case"2-digit":{l=(c=/^\d{1,2}/.exec(e))==null?void 0:c[0];break}}break}case"month":{switch(i.value){case"numeric":{l=(o=/^\d{1,2}/.exec(e))==null?void 0:o[0];break}case"2-digit":{l=(n=/^\d{2}/.exec(e))==null?void 0:n[0];break}case"narrow":{l=(s=/^[a-zA-Z]+/.exec(e))==null?void 0:s[0];break}case"short":{l=(m=/^[a-zA-Z]+/.exec(e))==null?void 0:m[0];break}case"long":{l=(f=/^[a-zA-Z]+/.exec(e))==null?void 0:f[0];break}default:throw Error(`ParserError: value "${i.value}" is not supported`)}break}case"day":{switch(i.value){case"numeric":{l=(p=/^\d{1,2}/.exec(e))==null?void 0:p[0];break}case"2-digit":{l=(v=/^\d{2}/.exec(e))==null?void 0:v[0];break}default:throw Error(`ParserError: value "${i.value}" is not supported`)}break}case"hour":{switch(i.value){case"numeric":{l=(y=/^\d{1,2}/.exec(e))==null?void 0:y[0],i.hour12&&parseInt(l)>12&&console.error("Trying to parse hour greater than 12. Use 'H' instead of 'h'.");break}case"2-digit":{l=(F=/^\d{2}/.exec(e))==null?void 0:F[0],i.hour12&&parseInt(l)>12&&console.error("Trying to parse hour greater than 12. Use 'HH' instead of 'hh'.");break}default:throw Error(`ParserError: value "${i.value}" is not supported`)}break}case"minute":{switch(i.value){case"numeric":{l=(H=/^\d{1,2}/.exec(e))==null?void 0:H[0];break}case"2-digit":{l=($=/^\d{2}/.exec(e))==null?void 0:$[0];break}default:throw Error(`ParserError: value "${i.value}" is not supported`)}break}case"second":{switch(i.value){case"numeric":{l=(A=/^\d{1,2}/.exec(e))==null?void 0:A[0];break}case"2-digit":{l=(R=/^\d{2}/.exec(e))==null?void 0:R[0];break}default:throw Error(`ParserError: value "${i.value}" is not supported`)}break}case"fractionalSecond":{l=(L=new RegExp(`^\\d{${i.value}}`).exec(e))==null?void 0:L[0];break}case"timeZoneName":{l=i.value;break}case"dayPeriod":{l=(j=/^(A|P)M/.exec(e))==null?void 0:j[0];break}case"literal":{if(!e.startsWith(i.value))throw Error(`Literal "${i.value}" not found "${e.slice(0,25)}"`);l=i.value;break}default:throw Error(`${i.type} ${i.value}`)}if(!l)throw Error(`value not valid for token { ${Y} ${l} } ${e.slice(0,25)}`);t.push({type:Y,value:l}),e=e.slice(l.length)}if(e.length)throw Error(`datetime string was not fully parsed! ${e.slice(0,25)}`);return t}sortDateTimeFormatPart(e){let t=[],a=["year","month","day","hour","minute","second","fractionalSecond"];for(let c of a){let o=e.findIndex(n=>n.type===c);o!==-1&&(t=t.concat(e.splice(o,1)))}return t=t.concat(e),t}partsToDate(e){let t=new Date,a=e.find(o=>o.type==="timeZoneName"&&o.value==="UTC"),c=e.find(o=>o.type==="day");a?t.setUTCHours(0,0,0,0):t.setHours(0,0,0,0);for(let o of e)switch(o.type){case"year":{let n=Number(o.value.padStart(4,"20"));a?t.setUTCFullYear(n):t.setFullYear(n);break}case"month":{let n=Number(o.value)-1;c?a?t.setUTCMonth(n,Number(c.value)):t.setMonth(n,Number(c.value)):a?t.setUTCMonth(n):t.setMonth(n);break}case"day":{let n=Number(o.value);a?t.setUTCDate(n):t.setDate(n);break}case"hour":{let n=Number(o.value),s=e.find(m=>m.type==="dayPeriod");(s==null?void 0:s.value)==="PM"&&(n+=12),a?t.setUTCHours(n):t.setHours(n);break}case"minute":{let n=Number(o.value);a?t.setUTCMinutes(n):t.setMinutes(n);break}case"second":{let n=Number(o.value);a?t.setUTCSeconds(n):t.setSeconds(n);break}case"fractionalSecond":{let n=Number(o.value);a?t.setUTCMilliseconds(n):t.setMilliseconds(n);break}}return t}parse(e){let t=this.parseToParts(e),a=this.sortDateTimeFormatPart(t);return this.partsToDate(a)}};b=new WeakMap;var se=1e3,ce=se*60,le=ce*60,ue=le*24,Be=ue*7;var J;(function(r){r[r.Sun=0]="Sun",r[r.Mon=1]="Mon",r[r.Tue=2]="Tue",r[r.Wed=3]="Wed",r[r.Thu=4]="Thu",r[r.Fri=5]="Fri",r[r.Sat=6]="Sat"})(J||(J={}));function B(r,e){let t=new E(e),a=t.parseToParts(r),c=t.sortDateTimeFormatPart(a);return t.partsToDate(c)}function T(r,e){return new E(e).format(r)}async function N(r="",e="",t=""){console.log(t);let a=B(e,"yyyy/MM/dd"),c="https://api.todoist.com/rest/v1/tasks",o={content:r,due_string:T(a,"yyyy-MM-dd")},n=globalThis.crypto.randomUUID(),s={"Content-Type":"application/json","X-Request-Id":n,Authorization:"Bearer "+t},m=await fetch(c,{method:"POST",headers:s,body:JSON.stringify(o)});return console.log(m),m}var{default:u,useState:U}=__ALEPH__.pack["https://esm.sh/react@17.0.2"];function P(r){let e=r.token;console.log(e);let[t,a]=U(T(new Date,"yyyy/MM/dd")),[c,o]=U(""),[n,s]=U("");function m(){console.log(c),console.log(t),console.log(e),N(c,t,e).then(async f=>{console.log("return add task?."),f!=null&&f.json().then(p=>{s(JSON.stringify(p))})})}return u.createElement("body",{className:"bg-right"},u.createElement("div",{className:"container"},u.createElement("h4",{className:"mb-3"},"add task"),u.createElement("div",{className:"col-md-8 order-md-1"},u.createElement(V,{label:"content",value:c,setValue:o}),u.createElement("button",{className:"btn btn-primary",onClick:m},"send"),u.createElement("div",{className:"col-md-6 mb-3"}),u.createElement(V,{label:"due date",value:t,setValue:a}),u.createElement("div",{className:"col-md-6 mb-3"},u.createElement("label",null)),u.createElement("div",{className:"col-md-6 mb-3"},u.createElement("label",null,"result"),u.createElement("div",{className:"card"},u.createElement("div",{className:"card-body"},u.createElement("p",{className:"card-text"},n)))),u.createElement("div",{className:"col-md-6 mb-3"},u.createElement("label",null,"api token"),u.createElement("div",{className:"card"},u.createElement("div",{className:"card-body"},u.createElement("p",{className:"card-text"},e)))))))}function V({label:r="",value:e="",setValue:t=null}){return u.createElement("div",{className:"col-md-6 mb-3"},u.createElement("label",null,r),u.createElement("input",{type:"text",className:"form-control",id:"firstName",value:e,onChange:a=>t(a.target.value)}))}var{default:ie}=__ALEPH__.pack["https://deno.land/x/aleph@v0.3.0-beta.19/framework/react/components/Head.ts"],{default:k,useEffect:rt,useState:at,useRef:ot,useCallback:nt}=__ALEPH__.pack["https://esm.sh/react@17.0.2"];function G(){console.log("render");let{query:r}=g();return k.createElement("div",{className:"page"},k.createElement(ie,null,k.createElement("title",null,"easy-todoist")),k.createElement("body",{className:"bg-right"},k.createElement(P,{token:r.get("token")})))}__ALEPH__.pack["/pages/run.tsx"]=D;})();
